{"version":3,"sources":["helpers/request.js","components/Login.js","helpers/json.js","components/Checkpoints.js","components/Users.js","components/Account.js","App.js","index.js"],"names":["sendRequest","url","a","method","body","fetch","JSON","stringify","undefined","headers","res","json","Login","onLoginRequest","useState","username","setUsername","password","setPassword","onSubmitLogin","event","preventDefault","isLoggedIn","class","onSubmit","for","value","onChange","target","type","id","name","placeholder","process","isValidJSON","val","parse","e","Checkpoints","onUpload","style","display","role","files","document","getElementById","length","fr","FileReader","onload","result","checkpoints","error","alert","reset","readAsText","item","ViewEnum","list","new","Users","currentUser","users","setUsers","view","setView","newUsername","setNewUsername","newCanManage","setNewCanManage","createdUsername","setCreatedUsername","createdPassword","setCreatedPassword","usersList","loadUsers","useEffect","onSubmitNewUser","test","privilege","user","created","handleDelete","userId","window","confirm","onClick","map","canManage","canDelete","checked","Account","currentPassword","setCurrentPassword","newPassword","setNewPassword","onSubmitNewPassword","App","setIsLoggedIn","setCurrentUser","hasSuperPrivilege","fetchCurrentUser","loginSuccessful","className","href","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.bb95961d.chunk.js","sourcesContent":["/* globals fetch */\n\nexport const sendRequest = async (url, method = 'GET', body) => {\n  const res = await fetch(url, {\n    method,\n    body: body ? JSON.stringify(body) : undefined,\n    headers: { 'Content-Type': 'application/json' }\n  })\n  return res.json()\n}\n","import React, { useState } from 'react'\nimport { sendRequest } from '../helpers/request'\n\nexport function Login ({ onLoginRequest }) {\n  const [username, setUsername] = useState('')\n  const [password, setPassword] = useState('')\n\n  const onSubmitLogin = async (event) => {\n    event.preventDefault()\n    const res = await sendRequest('/admin/login', 'POST', { username, password })\n    onLoginRequest(res && res.isLoggedIn)\n  }\n\n  const onchangeUsername = (event) => {\n    setUsername(event.target.value)\n  }\n\n  const onchangePassword = (event) => {\n    setPassword(event.target.value)\n  }\n\n  return (\n    <form class='form-signin' onSubmit={onSubmitLogin}>\n      <h1 class='h3 mb-3 font-weight-normal'>Please sign in</h1>\n      <label for='username' class='sr-only'>Username:</label><br />\n      <input value={username} onChange={onchangeUsername} type='text' id='username' name='username' placeholder='Username' class='form-control' /><br />\n      <label for='password' class='sr-only'>Password:</label><br />\n      <input value={password} onChange={onchangePassword} type='password' id='password' name='password' placeholder='Password' class='form-control' /><br /><br />\n      <button class='btn btn-lg btn-warning btn-block' type='submit'>Sign in</button>\n      <p class='mt-5 mb-3 text-muted'>{process.env.REACT_APP_NAME} Admin</p>\n    </form>\n  )\n}\n","export const isValidJSON = val => {\n  try {\n    JSON.parse(val)\n  } catch (e) {\n    return false\n  }\n  return true\n}\n","/* globals alert, FileReader */\nimport React from 'react'\nimport { sendRequest } from '../helpers/request'\nimport { isValidJSON } from '../helpers/json'\n\nexport function Checkpoints ({ onUpload }) {\n  const handleUpload = () => {\n    const files = document.getElementById('checkpoint-upload').files\n    if (files.length <= 0) {\n      return false\n    }\n    const fr = new FileReader()\n    fr.onload = async (e) => {\n      if (e && e.target.result && isValidJSON(e.target.result)) {\n        const result = JSON.parse(e.target.result)\n        const res = await sendRequest(\n          '/admin/api/checkpoints',\n          'POST',\n          { checkpoints: result }\n        )\n        if (res && !res.error) {\n          alert('The checkpoints were uploaded successfully.')\n        } else {\n          alert('Oops, that upload failed.')\n        }\n        document.getElementById('checkpoint-upload-form').reset()\n      } else {\n        alert('Oops, that upload failed.')\n      }\n    }\n    fr.readAsText(files.item(0))\n  }\n\n  return (\n    <div>\n      <div class='d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom'>\n        <h1 class='h2'>Upload Checkpoints</h1>\n      </div>\n      <form id='checkpoint-upload-form'>\n        <p>Click the button to upload a checkpoint history file.</p>\n        <p>A patient with a positive test can download this from the web app and email it to you to be uploaded here.</p>\n        <div class='alert alert-success' style={{ display: 'none' }} id='upload-success' role='alert'>\n          The checkpoints were uploaded successfully.\n        </div>\n        <input class='btn btn-large btn-warning' type='file' id='checkpoint-upload' onChange={handleUpload} />\n      </form>\n    </div>\n  )\n}\n","/* globals alert */\nimport React, { useEffect, useState } from 'react'\nimport { sendRequest } from '../helpers/request'\n\nconst superPrivilegeLevel = 1\nconst defaultPrivilegeLevel = 2\n\nconst ViewEnum = {\n  list: 1,\n  new: 2\n}\n\nexport function Users ({ currentUser }) {\n  const [users, setUsers] = useState(undefined)\n  const [view, setView] = useState(ViewEnum.list)\n  const [newUsername, setNewUsername] = useState('')\n  const [newCanManage, setNewCanManage] = useState(false)\n  const [createdUsername, setCreatedUsername] = useState('')\n  const [createdPassword, setCreatedPassword] = useState('')\n  const usersList = users || []\n\n  const loadUsers = async () => {\n    const res = await sendRequest('/admin/api/users')\n    if (res && res.users) {\n      setUsers(res.users)\n    }\n  }\n\n  useEffect(() => {\n    if (typeof users === 'undefined') {\n      loadUsers()\n    }\n  })\n\n  const onSubmitNewUser = async (event) => {\n    event.preventDefault()\n    const usernameRegex = /((^[a-z]+)|(^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+[0-9a-z]+$/i\n    if (usernameRegex.test(newUsername)) {\n      const privilege = newCanManage ? superPrivilegeLevel : defaultPrivilegeLevel\n      const res = await sendRequest(\n        '/admin/api/users',\n        'POST',\n        { username: newUsername, privilege }\n      )\n      if (res.error) {\n        alert('Oops, there was an error creating this user.')\n      } else {\n        setCreatedUsername(res.user.username)\n        setCreatedPassword(res.user.password)\n        setView(ViewEnum.created)\n        loadUsers()\n      }\n      setNewUsername('')\n      setNewCanManage(false)\n    } else {\n      alert('Only letters and numbers are allowed in a username.')\n    }\n  }\n\n  const onchangeUsername = (event) => {\n    setNewUsername(event.target.value)\n  }\n\n  const onchangeNewCanManage = () => {\n    setNewCanManage(!newCanManage)\n  }\n\n  const handleDelete = async (userId, username) => {\n    if (window.confirm(`Delete user: ${username}?`)) {\n      const res = await sendRequest(`/admin/api/users/${userId}`, 'DELETE')\n      if (res && !res.error) {\n        loadUsers()\n      } else {\n        alert('Oops, something went wrong.')\n      }\n    }\n  }\n\n  return (\n    <div>\n      <div class='d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom'>\n        <h1 class='h2'>Users</h1>\n      </div>\n      {view === ViewEnum.list && (\n        <div>\n          <a class='btn btn-dark text-light mb-2' onClick={() => setView(ViewEnum.new)}>\n            New user\n          </a>\n          <ul class='list-group'>\n            {usersList.map(user => {\n              const canManage = user.privilege === superPrivilegeLevel\n              const canDelete = user.id !== currentUser.id\n              return (\n                <li class='list-group-item user-list'>\n                  <strong>{user.username}</strong>\n                  {canManage && (\n                    <span> (can manage users)</span>\n                  )}\n                  {canDelete && (\n                    <a onClick={() => handleDelete(user.id, user.username)} class='btn btn-danger text-light user-delete'>\n                      Delete\n                    </a>\n                  )}\n                </li>\n              )\n            })}\n          </ul>\n        </div>\n      )}\n      {view === ViewEnum.new && (\n        <form class='form-signin' onSubmit={onSubmitNewUser}>\n          <h2 class='h3 mb-3 font-weight-normal'>Create a new user</h2>\n          <label for='username' class='sr-only'>Username:</label>\n          <input value={newUsername} onChange={onchangeUsername} type='text' id='username' name='username' placeholder='Username' class='form-control' />\n          <div class='form-check'>\n            <input checked={newCanManage} onChange={onchangeNewCanManage} class='form-check-input' type='checkbox' id='can-manage' />\n            <label class='form-check-label' for='can-manage'>\n              Can manage other users\n            </label>\n          </div>\n          <button class='btn btn-lg btn-warning btn-block mt-3' type='submit'>Create</button>\n        </form>\n      )}\n      {view === ViewEnum.created && (\n        <div>\n          <h2 class='h3 mb-3 font-weight-normal'>A new user was created with the following credentials:</h2>\n          <p>Username: <strong>{createdUsername}</strong></p>\n          <p>Temporary password: <strong>{createdPassword}</strong></p>\n          <p>Please provide these credentials to the user and instruct them to change their password once they log in.</p>\n          <a class='btn btn-dark text-light mt-2' onClick={() => setView(ViewEnum.list)}>\n            Return to all users\n          </a>\n        </div>\n      )}\n    </div>\n  )\n}\n","/* globals alert */\nimport React, { useState } from 'react'\nimport { sendRequest } from '../helpers/request'\n\nexport function Account () {\n  const [currentPassword, setCurrentPassword] = useState('')\n  const [newPassword, setNewPassword] = useState('')\n\n  const onSubmitNewPassword = async (event) => {\n    event.preventDefault()\n    const passwordRegex = /^[\\w!@#$%^&*]{8,}$/\n    if (passwordRegex.test(newPassword)) {\n      const res = await sendRequest(\n        '/admin/api/account',\n        'PUT',\n        { currentPassword, newPassword }\n      )\n      if (res.error) {\n        alert('Current password is incorrect.')\n      } else {\n        alert('Your password was updated successfully.')\n        setCurrentPassword('')\n        setNewPassword('')\n      }\n    } else {\n      alert('New password is not valid.')\n    }\n  }\n\n  const onchangeCurrentPassword = (event) => {\n    setCurrentPassword(event.target.value)\n  }\n\n  const onchangeNewPassword = (event) => {\n    setNewPassword(event.target.value)\n  }\n\n  return (\n    <div>\n      <div class='d-flex justify-content-between flex-wrap flex-md-nowrap align-items-left pt-3 pb-2 mb-3 border-bottom'>\n        <h1 class='h2'>Account</h1>\n      </div>\n      <form class='form-signin' onSubmit={onSubmitNewPassword}>\n        <h2 class='h3 mb-3 font-weight-normal'>Update password</h2>\n        <p>Passwords must be at least 8 characters long.</p>\n        <label for='current-password' class='sr-only'>Current password:</label>\n        <input value={currentPassword} onChange={onchangeCurrentPassword} type='password' id='username' name='current-password' placeholder='Current password' class='form-control' />\n        <label for='new-password' class='sr-only'>New password:</label>\n        <input value={newPassword} onChange={onchangeNewPassword} type='password' id='username' name='new-password' placeholder='New password' class='form-control' />\n        <button class='btn btn-lg btn-warning btn-block mt-3' type='submit'>Update</button>\n      </form>\n    </div>\n  )\n}\n","/* globals alert */\nimport React, { useEffect, useState } from 'react'\nimport './App.css'\nimport { sendRequest } from './helpers/request'\nimport { Login } from './components/Login'\nimport { Checkpoints } from './components/Checkpoints'\nimport { Users } from './components/Users'\nimport { Account } from './components/Account'\n\nconst ViewEnum = {\n  checkpoints: 1,\n  users: 2,\n  account: 3\n}\n\nconst superPrivilegeLevel = 1\n\nfunction App () {\n  const [isLoggedIn, setIsLoggedIn] = useState(undefined)\n  const [currentUser, setCurrentUser] = useState({})\n  const [view, setView] = useState(ViewEnum.checkpoints)\n  const hasSuperPrivilege = (currentUser && currentUser.privilege === superPrivilegeLevel)\n\n  const fetchCurrentUser = async () => {\n    const res = await sendRequest('/admin/api/status')\n    if (res) {\n      setIsLoggedIn(res.isLoggedIn)\n      setCurrentUser(res.user)\n    }\n  }\n\n  useEffect(() => {\n    if (typeof isLoggedIn === 'undefined') {\n      fetchCurrentUser()\n    }\n  })\n\n  const onSubmitLogin = async (loginSuccessful) => {\n    if (loginSuccessful) {\n      fetchCurrentUser()\n    } else {\n      alert('Login failed')\n    }\n  }\n\n  if (isLoggedIn) {\n    return (\n      <div className='App'>\n        <nav class='navbar navbar-dark fixed-top bg-dark flex-md-nowrap p-0 shadow'>\n          <a class='navbar-brand col-sm-3 col-md-2 mr-0' href='/admin'>{process.env.REACT_APP_NAME} Admin</a>\n          <ul class='navbar-nav px-3'>\n            <li class='nav-item text-nowrap'>\n              <a class='nav-link' href='/admin/logout'>Sign out</a>\n            </li>\n          </ul>\n        </nav>\n\n        <div class='container-fluid'>\n          <div class='row'>\n            <nav class='col-md-2 d-none d-md-block bg-light sidebar'>\n              <div class='sidebar-sticky'>\n                <ul class='nav flex-column'>\n                  <li class='nav-item'>\n                    <a class='nav-link' onClick={() => setView(ViewEnum.checkpoints)}>\n                      Checkpoints\n                    </a>\n                  </li>\n                  {hasSuperPrivilege && (\n                    <li class='nav-item'>\n                      <a class='nav-link' onClick={() => setView(ViewEnum.users)}>\n                        Users\n                      </a>\n                    </li>\n                  )}\n                  <li class='nav-item'>\n                    <a class='nav-link' onClick={() => setView(ViewEnum.account)}>\n                      Account\n                    </a>\n                  </li>\n                </ul>\n              </div>\n            </nav>\n\n            <main role='main' class='col-md-9 ml-sm-auto col-lg-10 px-4'>\n              <p class='mt-3'>Welcome, {currentUser.username}.</p>\n              {view === ViewEnum.checkpoints && (\n                <Checkpoints />\n              )}\n              {hasSuperPrivilege && view === ViewEnum.users && (\n                <Users currentUser={currentUser} />\n              )}\n              {view === ViewEnum.account && (\n                <Account />\n              )}\n            </main>\n          </div>\n        </div>\n      </div>\n    )\n  } else {\n    return (\n      <div class='login-container bg-dark text-center text-light'>\n        <Login onLoginRequest={onSubmitLogin} />\n      </div>\n    )\n  }\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport './bootstrap.min.css'\nimport App from './App'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n"],"sourceRoot":""}